const Discord = require('discord.js');
const client = new Discord.Client();
const { MessageButton, MessageActionRow } = require('discord-buttons');
require('discord-buttons')(client);

// ID del canal donde se enviará el mensaje de verificación
const CHANNEL_ID = '1274443859207655434';
// ID del rol que se asignará a los usuarios al verificarse
const ROLE_ID = '1274445003669635204';

client.on("ready", () => {
    console.log("Bot online");

    // Obtén el canal específico usando su ID
    const channel = client.channels.cache.get(CHANNEL_ID);
    if (channel) {
        // Crea un embed con un mensaje de verificación
        const embed = new Discord.MessageEmbed()
            .setTitle("Welcome to Thunder Development")
            .setDescription("Please verify by clicking on the button below.")
            .setColor('#38A800');

        // Crea un botón de verificación
        let verifyButton = new MessageButton()
            .setLabel("Verify")
            .setStyle("blurple")
            .setEmoji("✅")
            .setID("Verify");

        // Crea una fila de acción para el botón
        const row = new MessageActionRow().addComponents(verifyButton);

        // Envía el mensaje de verificación al canal especificado
        channel.send({
            embeds: [embed],
            components: [row]
        });
    } else {
        console.log("Canal no encontrado");
    }
});

client.on('clickButton', async (button) => {
    if (button.id !== "Verify") return;

    // Envía un mensaje de confirmación
    button.reply.send('You are now successfully verified.', true);

    // Agrega el rol de verificación al usuario
    const role = button.guild.roles.cache.get(ROLE_ID);
    const member = button.clicker.member;

    if (role && member) {
        await member.roles.add(role);
        console.log(`Rol ${role.name} añadido a ${member.user.tag}`);
    } else {
        console.log("Rol o miembro no encontrado");
    }
});

client.login('your-bot-token');
